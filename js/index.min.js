const _user_id=sessionStorage.getItem("user"),_user_name=sessionStorage.getItem("name");function mainload(){function getUsers(){$.get("./inc/post.inc.php?user="+_user_id,(function(posts){posts instanceof Array?(posts.forEach(post=>{$("#main-post").append(render(post))}),addClick(),add_lightbox()):$("#main-post").append("<div class='post-div shadow no-user' class='text-center'><h4> you need to follow someone in order to view post on your feed</h4>\n               <p> go to <a href=\"search.php?q=e\"><b>search</b></a> and look for a user to follow</p>  \n            </div>")}))}$("#image_post").on("change",(function(e){e.preventDefault();var m=URL.createObjectURL(event.target.files[0]);$("#type").val("img"),$("#imagedisp").attr("src",m)})),getUsers()}function render(post){return post.liked?l="fa-heart like":l="fa-heart-o",!0===post.user?_user={name:_user_name,id:_user_id}:_user=post.user,"img"==post.type?`\n      <div class="post-div shadow">\n            <div class="post-head  py-3 d-flex flex-row align-items-center justify-content-between">\n                <a href="profile.php?id=${_user.id}"> \n                    <h5 class="text-left text-muted usn py-2 ml-1">@${_user.name}</h5>\n                </a>\n                <div id='date' class="d-flex flex-row align-items-center justify-content-between">\n                    <p class="text-muted">${post.date_posted}</p>\n                    </div>        \n                <div class="dropdown no-arrow">\n                    <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                        <i class="fa fa-ellipsis-v fa-sm fa-fw text-dark"></i>\n                    </a>\n                    <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in" aria-labelledby="dropdownMenuLink" style="">\n                        <div class="dropdown-header">Actions:</div>\n                        <a class="dropdown-item mj-actions post-page" href="post.php?id=${post.post_id}">\n                            <i class="fa fa-eye fa-fw"></i> View Post\n                        </a>\n                        <a class="dropdown-item mj-actions share" id="${post.post_id}" href="#share">\n                            <i class="fa fa-share-alt fa-fw"></i> Share\n                        </a>\n                        <a class="dropdown-item mj-actions report" id="${post.id}" href="#report">\n                            <i class="fa fa-flag fa-fw"></i> Report\n                        </a>\n                        <a class="dropdown-item mj-actions  embed tocome" id="${post.post_id}" href="#embed">\n                            <i class="fa fa-code fa-fw"></i> Embed\n                        </a>\n                        <div class="dropdown-divider"></div>\n                        <a class="dropdown-item" href="profile.php?id=${_user.post_id}">visit profile</a>\n                    </div>\n                </div>\n            </div>\n           <div class="lazyload">\n           \x3c!-- <a href="./img/${post.image}"  data-lightbox data-image-alt="image post">     \n                   <div class="post-body" style="background-image: url(./img/${post.image});">\n                    </div> \n             </a> --\x3e \n             </div>\n          \n              <p class="post-text py-1 mx-1">${post.image_text}</p>\n            <div class="social-opt">\n                <div class="social-act">\n                    <i title="like" id="${post.id}" class="fa ${l} this-click  fa-2x">${post.post_likes||""}</i>\n                    <a href="./comment.php?id=${post.post_id}"> <i title="comment" id="comment" class="fa fa-comment-o comment  fa-2x">${post.comments||""}</i></a>\n                    <a href="#share"  class="share" id="${post.id}"><i title="share this post" class="fa fa-share  fa-2x"></i></a>                 </div>\n            </div>\n        </div>\n                 \n \n         `:`\n        <div class="post-div shadow">\n        <div class="post-head  py-3 d-flex flex-row align-items-center justify-content-between">\n        <a href="profile.php?id=${_user.id}"> \n            <h5 class="text-left text-muted usn py-2 ml-1">@${_user.name}</h5>\n        </a>\n        <div id='date' class="d-flex flex-row align-items-center justify-content-between">\n            <p class="text-muted">${post.date_posted}</p>\n            </div>        \n        <div class="dropdown no-arrow">\n            <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                <i class="fa fa-ellipsis-v fa-sm fa-fw text-dark"></i>\n            </a>\n            <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in" aria-labelledby="dropdownMenuLink" style="">\n                <div class="dropdown-header">Actions:</div>\n                <a class="dropdown-item mj-actions post-page" href="post.php?id=${post.post_id}">\n                    <i class="fa fa-eye fa-fw"></i> View Post\n                </a>\n                <a class="dropdown-item mj-actions share" id="${post.post_id}" href="#share">\n                    <i class="fa fa-share-alt fa-fw"></i> Share\n                </a>\n                <a class="dropdown-item mj-actions report" id="${post.id}" href="#report">\n                    <i class="fa fa-flag fa-fw"></i> Report\n                </a>\n                <a class="dropdown-item mj-actions  embed tocome" id="${post.post_id}" href="#embed">\n                    <i class="fa fa-code fa-fw"></i> Embed\n                </a>\n                <div class="dropdown-divider"></div>\n                <a class="dropdown-item" href="profile.php?id=${_user.post_id}">visit profile</a>\n            </div>\n        </div>\n    </div>\n            <div class="px-1 py-3">\n            <p class="lone px-1">${post.image_text}</p>\n            </div>\n            <div class="social-opt">\n                <div class="social-act">\n                <i title="like" id="${post.id}" class="fa ${l} this-click  fa-2x">${post.post_likes||""}</i>\n                <a href="./comment.php?id=${post.post_id}"> <i title="comment" id="comment" class="fa fa-comment-o comment  fa-2x">${post.comments||""}</i></a>                  <a href="#share"  class="share" id="${post.id}"><i title="share this post" class="fa fa-share  fa-2x"></i></a> \n                </div>\n            </div>\n        </div>\n                 `}function addClick(){$(".this-click").click((function(like){let url=`./inc/like.inc.php?user=${_user_id}&id=${this.id}`;if(this.classList.contains("fa-heart")){$(this).attr("class"," fa fa-heart-o icon-click fa-2x");let l=parseInt($(this).text())-1;$(this).text(l),url=url+"&like="+l+"&key=false",$.get(url,(function(response){}))}else{let l=parseInt($(this).text())+1;$(this).text(l),url=url+"&like="+l+"&key=true",$(this).attr("class","fa fa-heart icon-click like fa-2x"),$.get(url,(function(response){}))}})),$(".share").click((async function(e){e.preventDefault;const shareData={url:window.location.href};try{await navigator.share(shareData),$.post("./inc/share.inc.php",{id:_user_id})}catch(err){}})),$(".report").click((function(e){e.preventDefault,$.post("./inc/report.inc.php",{id:this.id},(function(data){alert(data)}))})),$(".tocome").click((function(){alert("I am still working on this...")})),$(".lazyload").lazyload()}function profile_request(profile){url="./inc/profile.inc.php?id="+profile+"&user="+_user_id,$.get(url,(function(user){user.user?($("#profile-name").text(user.user.usersFirstname+" "+user.user.usersSecondname),$(".userName").text("@"+user.user.uidusers),$(".message-btn").attr("href","message.php?id="+user.user.chat_auth),$("#following").text("following: "+user.user.following),$("#followers").text("followers: "+user.user.followers),$(".bio").text(user.user.bio),null!==user.user.profile_picture&&$(".profile-pic").attr("src","img/"+user.user.profile_picture),user==user.user.uidusers&&$(".btn").hide(),follow(),user.posts&&(user.posts.forEach(async post=>{await $("#main-post").append(render(post))}),addClick())):($(".bio").text("an unknown user"),$(".btn").hide())}))}function post_request(profile){url="./inc/post.inc.php?id="+profile,$.get(url,(function(post){$("#main-post").append(render(post)),addClick()}))}function report(){}function follow(user){user=user||_user_id,$(".follow-btn").click((function(){var key;switch(profile=this.id||profile,$(this).text()){case"follow":key="true",$(this).text("following");break;default:key="false",$(this).text("follow")}url="./inc/follow.inc.php?user="+user+"&following="+profile+"&key="+key,$.get(url,(function(follow){}))}))}function add_lightbox(){$("body").append('<script defer src="./lib/lightbox/lightbox.min.js"><\/script>  ')}$("#logout").click((function(){sessionStorage.clear()}));